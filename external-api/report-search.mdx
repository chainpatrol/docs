---
title: Report Search
openapi: "POST /reports/search"
---

<Warning>
  This API requires an API key with appropriate permissions. See [API Key
  Documentation](https://chainpatrol.com/docs/general/api-key) for more details.
</Warning>

## Overview

The Report Search endpoint allows you to check if reports already exist for specific assets within your organization. This endpoint helps you avoid creating duplicate reports by checking the status of existing reports before submission.

## Quick Start

### Authentication

Include your API key in the `X-API-KEY` header:

```bash
X-API-KEY: your_api_key_here
```

### Example Request

<CodeGroup>

```typescript TypeScript
const response = await fetch(
  "https://app.chainpatrol.io/api/v2/reports/search",
  {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "X-API-KEY": "YOUR_API_KEY_HERE",
    },
    body: JSON.stringify({
      assetContents: [
        "https://scam-site.com",
        "phishing.example",
        "eip155:1:0x1234567890abcdef1234567890abcdef12345678",
      ],
    }),
  }
);

const data = await response.json();
console.log(data);
```

```javascript JavaScript
const response = await fetch(
  "https://app.chainpatrol.io/api/v2/reports/search",
  {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "X-API-KEY": "YOUR_API_KEY_HERE",
    },
    body: JSON.stringify({
      assetContents: [
        "https://scam-site.com",
        "phishing.example",
        "eip155:1:0x1234567890abcdef1234567890abcdef12345678",
      ],
    }),
  }
);

const data = await response.json();
console.log(data);
```

```python Python
import requests

response = requests.post(
    "https://app.chainpatrol.io/api/v2/reports/search",
    headers={
        "Content-Type": "application/json",
        "X-API-KEY": "YOUR_API_KEY_HERE",
    },
    json={
        "assetContents": [
            "https://scam-site.com",
            "phishing.example",
            "eip155:1:0x1234567890abcdef1234567890abcdef12345678"
        ]
    },
)

data = response.json()
print(data)
```

```bash cURL
curl -X POST 'https://app.chainpatrol.io/api/v2/reports/search' \
  -H 'X-API-KEY: YOUR_API_KEY_HERE' \
  -H 'Content-Type: application/json' \
  -d '{
    "assetContents": [
      "https://scam-site.com",
      "phishing.example",
      "eip155:1:0x1234567890abcdef1234567890abcdef12345678"
    ]
  }'
```

</CodeGroup>

## Request Parameters

| Parameter     | Type     | Required | Description                   |
| ------------- | -------- | -------- | ----------------------------- |
| assetContents | string[] | Yes      | Array of assets to search for |

## Response

### Success Response

```json
{
  "reports": [
    {
      "id": 12345,
      "status": "TODO",
      "assets": ["https://scam-site.com", "phishing.example"]
    },
    {
      "id": 12346,
      "status": "IN_PROGRESS",
      "assets": ["eip155:1:0x1234567890abcdef1234567890abcdef12345678"]
    }
  ]
}
```

### Response Fields

| Field   | Type     | Description                                     |
| ------- | -------- | ----------------------------------------------- |
| reports | array    | Array of existing reports (empty if none found) |
| id      | number   | Unique report identifier                        |
| status  | string   | Current status of the report                    |
| assets  | string[] | Array of asset contents in this report          |

### Report Status Values

| Status        | Description                         |
| ------------- | ----------------------------------- |
| `TODO`        | Report is pending initial review    |
| `IN_PROGRESS` | Report is currently being processed |
| `COMPLETED`   | Report has been fully processed     |
| `CANCELLED`   | Report was cancelled                |

## Error Responses

### 401 Unauthorized

Returned when the API key is missing, invalid, or doesn't have the required permissions.

```json
{
  "message": "API Organization not found. Invalid or missing API key.",
  "code": "UNAUTHORIZED"
}
```

### 500 Internal Server Error

Returned for unexpected server conditions. The response uses safe, generic messages to avoid exposing internal system details.

```json
{
  "message": "An unexpected error occurred and has been reported to the team",
  "code": "INTERNAL_SERVER_ERROR"
}
```

## Use Cases

### Pre-Check Before Report Creation

Use this endpoint to check if reports already exist before attempting to create new ones:

```typescript
// Check for existing reports first
const searchResponse = await fetch("/api/v2/reports/search", {
  method: "POST",
  headers: {
    "Content-Type": "application/json",
    "X-API-KEY": "YOUR_API_KEY_HERE",
  },
  body: JSON.stringify({
    assetContents: ["https://suspicious-site.com"],
  }),
});

const searchData = await searchResponse.json();

if (searchData.reports.length > 0) {
  console.log("Report already exists:", searchData.reports[0]);
  // Handle existing report case
} else {
  // Proceed with creating a new report
  const createResponse = await fetch("/api/v2/report/create", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "X-API-KEY": "YOUR_API_KEY_HERE",
    },
    body: JSON.stringify({
      organizationSlug: "your-organization",
      assets: ["https://suspicious-site.com"],
      reason: "phishing",
    }),
  });
}
```

### Batch Asset Checking

Check multiple assets at once to see which ones already have reports:

```typescript
const assetsToCheck = [
  "https://scam-site-1.com",
  "https://scam-site-2.com",
  "phishing.example",
];

const response = await fetch("/api/v2/reports/search", {
  method: "POST",
  headers: {
    "Content-Type": "application/json",
    "X-API-KEY": "YOUR_API_KEY_HERE",
  },
  body: JSON.stringify({
    assetContents: assetsToCheck,
  }),
});

const data = await response.json();

// Group results by status
const reportsByStatus = data.reports.reduce((acc, report) => {
  if (!acc[report.status]) {
    acc[report.status] = [];
  }
  acc[report.status].push(report);
  return acc;
}, {});

console.log("Reports by status:", reportsByStatus);
```

## Best Practices

### Asset Format

Use the same asset format as you would for report creation:

- **URLs**: Include the full protocol (`https://` or `http://`)
- **Domains**: Use clean domain names without protocols or paths
- **Blockchain Addresses**: Use EIP-155 format for Ethereum addresses

### Performance Tips

- Batch multiple assets in a single request when possible
- Cache results for frequently checked assets
- Use this endpoint before report creation to avoid duplicate submissions

### Error Handling

- Always check for 401 errors to ensure proper authentication
- Implement retry logic for 500 errors with exponential backoff
- Handle empty results gracefully (no existing reports found)

## Integration Examples

### Workflow Integration

```typescript
async function checkAndCreateReport(
  assets: string[],
  organizationSlug: string
) {
  try {
    // Step 1: Check for existing reports
    const searchResponse = await fetch("/api/v2/reports/search", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "X-API-KEY": process.env.CHAINPATROL_API_KEY,
      },
      body: JSON.stringify({ assetContents: assets }),
    });

    if (!searchResponse.ok) {
      throw new Error(`Search failed: ${searchResponse.status}`);
    }

    const searchData = await searchResponse.json();

    if (searchData.reports.length > 0) {
      // Handle existing reports
      console.log("Found existing reports:", searchData.reports);
      return {
        success: false,
        reason: "reports_exist",
        existingReports: searchData.reports,
      };
    }

    // Step 2: Create new report if none exist
    const createResponse = await fetch("/api/v2/report/create", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "X-API-KEY": process.env.CHAINPATROL_API_KEY,
      },
      body: JSON.stringify({
        organizationSlug,
        assets,
        reason: "phishing",
      }),
    });

    const createData = await createResponse.json();
    return {
      success: true,
      reportId: createData.reportId,
    };
  } catch (error) {
    console.error("Error in checkAndCreateReport:", error);
    throw error;
  }
}
```

## Troubleshooting

### Common Issues

**Empty results when you expect reports:**

- Verify the asset format matches exactly what was used in the original report
- Check that you're using the correct organization's API key
- Ensure the assets are properly normalized (URLs, domains, etc.)

**401 Unauthorized errors:**

- Verify your API key is correct and active
- Check that the API key has the required permissions
- Ensure the `X-API-KEY` header is properly set

**500 Internal Server Error:**

- Implement retry logic with exponential backoff
- Contact support if errors persist
- Check the API status page for known issues

### Rate Limiting

The endpoint implements rate limiting to prevent abuse. If you encounter rate limit errors:

- Implement exponential backoff in your retry logic
- Consider batching requests to reduce API calls
- Contact support for higher rate limits if needed

## Notes

- This endpoint only searches within your organization's reports
- Results are returned in real-time and reflect the current state of reports
- Asset matching is done on normalized content, so slight format differences may not match
- Use this endpoint proactively to avoid creating duplicate reports
- For technical issues or questions, contact support@chainpatrol.io


